
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Clean desk &#8212; The DataLad Handbook</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="canonical" href="http://handbook.datalad.org/basics/101-112-run4.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Summary" href="101-113-summary.html" />
    <link rel="prev" title="Input and output" href="101-110-run2.html" />
  

  

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    div.body {
      min-width: initial;
      max-width: initial;
    }
  </style>

  
  <link rel="canonical" href="https://handbook.datalad.org/basics/101-112-run4/"/>
  <meta property="og:url" content="https://handbook.datalad.org/basics/101-112-run4">
  

  <link rel="icon" type="image/png" href="https://media.readthedocs.org/images/favicon.png">

  <meta name="twitter:card" content="summary">
  <meta property="twitter:image" content="https://handbook.datalad.org/_static/social-card.jpg">
  <meta property="og:image" content="https://handbook.datalad.org/_static/social-card.jpg">
  <meta property="og:title" content="Clean desk &#8212; The DataLad Handbook">
  <meta property="og:type" content="article">
  
  <meta property="og:description" content="">


  </head><body>
  <script type="text/javascript">

  $(window).scroll(function () {
    var s = $(window).scrollTop(),
          d = $(document).height(),
          c = $(window).height();
          scrollPercent = (s / (d-c)) * 100;
          var position = scrollPercent;

     $("#progressbar").attr('value', position);
  });
  </script>

  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" title="The DataLad Handbook"/>
  </a>
</p>

<p style="margin-left:auto; margin-right: auto;"><iframe src="https://ghbtns.com/github-btn.html?repo=book&user=datalad-handbook&type=star&count=true&size=large" allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe></p>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
<style>
.algolia-autocomplete{
  width: 100%;
  height: 1.5em
}
.algolia-autocomplete a{
  border-bottom: none !important;
}
#doc_search{
  width: 100%;
  height: 100%;
}
</style>

<progress id="progressbar" value="0" max="100"></progress>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Clean desk</a><ul>
<li><a class="reference internal" href="#oh-for-f-sake-run-is-impossible">Oh for f**** sake… run is “impossible”?</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="101-110-run2.html" title="previous chapter">Input and output</a></li>
      <li>Next: <a href="101-113-summary.html" title="next chapter">Summary</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><!-- Alabaster (krTheme++) Hacks -->
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            <div style="display:block;position:relative; margin-bottom: 1em;">
              <div style="display:block;width:100%;padding-top:12.5%;"></div>
              <div class="rpad" data-unit="8x1" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;"></div>
            </div>
            
  <div class="section" id="clean-desk">
<span id="run5"></span><h1>Clean desk<a class="headerlink" href="#clean-desk" title="Permalink to this headline">¶</a></h1>
<p>Just now you realize that you need to fit both logos onto the same slide.
“Ah, damn, I might then really need to have them 400 by 400 pixel to fit”,
you think. “Good that I know how to not run into the permission denied errors anymore!”</p>
<p>Therefore, we need to do the <strong class="command">datalad run</strong> command yet again - we wanted to have
the image in 400x400 px size. “Now this definitely will be the last time I’m running this”,
you think.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad run -m <span class="s2">&quot;Resize logo for slides&quot;</span> <span class="se">\</span>
--input <span class="s2">&quot;recordings/longnow/.datalad/feed_metadata/logo_interval.jpg&quot;</span> <span class="se">\</span>
--output <span class="s2">&quot;recordings/interval_logo_small.jpg&quot;</span> <span class="se">\</span>
<span class="s2">&quot;convert -resize 400x400 recordings/longnow/.datalad/feed_metadata/logo_interval.jpg recordings/interval_logo_small.jpg&quot;</span>
<span class="hll"><span class="go">run(impossible): /home/me/dl-101/DataLad-101 (dataset) [clean dataset required to detect changes from command; use `datalad status` to inspect unsaved changes]</span>
</span></pre></div>
</div>
<div class="section" id="oh-for-f-sake-run-is-impossible">
<h2>Oh for f**** sake… run is “impossible”?<a class="headerlink" href="#oh-for-f-sake-run-is-impossible" title="Permalink to this headline">¶</a></h2>
<p>Weird. After the initial annoyance about yet another error message faded,
and you read on,
DataLad informs that a “clean dataset” is required.
Run a <strong class="command">datalad status</strong> to see what is meant by this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad status
<span class="go"> modified: notes.txt (file)</span>
</pre></div>
</div>
<p>Ah right. We forgot to save the notes we added, and thus there are
unsaved modifications present in <code class="docutils literal notranslate"><span class="pre">DataLad-101</span></code>.
But why is this a problem?</p>
<p>By default, at the end of a <strong class="command">datalad run</strong> is a <strong class="command">datalad save</strong>.
Remember the section on <a class="reference internal" href="101-102-populate.html#populate"><span class="std std-ref">Populate a dataset</span></a>: A general <strong class="command">datalad save</strong> without
a path specification will save <em>all</em> of the modified or untracked
contents to the dataset.</p>
<p>Therefore, in order to not mix any changes in the dataset that are unrelated
to the command plugged into <strong class="command">datalad run</strong>, by default it will only run
on a clean dataset with no changes or untracked files present.</p>
<p>There are two ways to get around this error message:
The obvious – and recommended – one is to save the modifications,
and run the command in a clean dataset.
We will try this way with the <code class="docutils literal notranslate"><span class="pre">logo_interval.jpg</span></code>.
It would look like this:
First, save the changes,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad save -m <span class="s2">&quot;add additional notes on run options&quot;</span>
<span class="go">add(ok): notes.txt (file)</span>
<span class="go">save(ok): . (dataset)</span>
<span class="go">action summary:</span>
<span class="go">  add (ok: 1)</span>
<span class="go">  save (ok: 1)</span>
</pre></div>
</div>
<p>and then try again:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad run -m <span class="s2">&quot;Resize logo for slides&quot;</span> <span class="se">\</span>
--input <span class="s2">&quot;recordings/longnow/.datalad/feed_metadata/logo_interval.jpg&quot;</span> <span class="se">\</span>
--output <span class="s2">&quot;recordings/interval_logo_small.jpg&quot;</span> <span class="se">\</span>
<span class="s2">&quot;convert -resize 400x400 recordings/longnow/.datalad/feed_metadata/logo_interval.jpg recordings/interval_logo_small.jpg&quot;</span>
<span class="go">[INFO] Making sure inputs are available (this may take some time) </span>
<span class="go">[INFO] == Command start (output follows) ===== </span>
<span class="go">[INFO] == Command exit (modification check follows) ===== </span>
<span class="go">unlock(ok): recordings/interval_logo_small.jpg (file)</span>
<span class="go">add(ok): recordings/interval_logo_small.jpg (file)</span>
<span class="go">save(ok): . (dataset)</span>
<span class="go">action summary:</span>
<span class="go">  add (ok: 1)</span>
<span class="go">  get (notneeded: 1)</span>
<span class="go">  save (notneeded: 1, ok: 1)</span>
<span class="go">  unlock (ok: 1)</span>
</pre></div>
</div>
<p>Note how in this execution of <strong class="command">datalad run</strong>, output unlocking was actually
necessary and DataLad provides a summary of this action in its output.</p>
<p>Add a quick addition to your notes about this way of cleaning up prior
to a <strong class="command">datalad run</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cat &lt;&lt; EOT &gt;&gt; notes.txt
<span class="go">Important! If the dataset is not &quot;clean&quot; (a datalad status output is empty),</span>
<span class="go">datalad run will not work - you will have to save modifications present in your</span>
<span class="go">dataset.</span>
<span class="go">EOT</span>
</pre></div>
</div>
<p>A way of executing a <strong class="command">datalad run</strong> <em>despite</em> an “unclean” dataset,
though, is to add the <code class="docutils literal notranslate"><span class="pre">--explicit</span></code> flag to <strong class="command">datalad run</strong>.
We will try this flag with the remaining <code class="docutils literal notranslate"><span class="pre">logo_salt.jpg</span></code>. Note that
we have an “unclean dataset” again because of the
addition to the note.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad run -m <span class="s2">&quot;Resize logo for slides&quot;</span> <span class="se">\</span>
--input <span class="s2">&quot;recordings/longnow/.datalad/feed_metadata/logo_salt.jpg&quot;</span> <span class="se">\</span>
--output <span class="s2">&quot;recordings/salt_logo_small.jpg&quot;</span> <span class="se">\</span>
--explicit <span class="se">\</span>
<span class="s2">&quot;convert -resize 400x400 recordings/longnow/.datalad/feed_metadata/logo_salt.jpg recordings/salt_logo_small.jpg&quot;</span>
<span class="go">[INFO] Making sure inputs are available (this may take some time) </span>
<span class="go">[INFO] == Command start (output follows) ===== </span>
<span class="go">[INFO] == Command exit (modification check follows) ===== </span>
<span class="go">unlock(ok): recordings/salt_logo_small.jpg (file)</span>
<span class="go">add(ok): recordings/salt_logo_small.jpg (file)</span>
<span class="go">save(ok): . (dataset)</span>
<span class="go">action summary:</span>
<span class="go">  add (ok: 1)</span>
<span class="go">  get (notneeded: 1)</span>
<span class="go">  save (ok: 1)</span>
<span class="go">  unlock (ok: 1)</span>
</pre></div>
</div>
<p>With this flag, DataLad considers the specification of inputs and outputs to be “explicit”.
It doesn’t warn if the repository is dirty, but importantly, it
<strong>only</strong> saves modifications to the <em>listed outputs</em> (which is a problem in the
vast amount of cases where one does not exactly know which outputs are produced).</p>
<p>A <strong class="command">datalad status</strong> will show that your previously modified <code class="docutils literal notranslate"><span class="pre">notes.txt</span></code>
is still modified:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad status
<span class="go"> modified: notes.txt (file)</span>
</pre></div>
</div>
<p>Add an additional note on the <code class="docutils literal notranslate"><span class="pre">--explicit</span></code> flag, and finally save your changes to <code class="docutils literal notranslate"><span class="pre">notes.txt</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cat &lt;&lt; EOT &gt;&gt; notes.txt
<span class="go">A suboptimal alternative is the --explicit flag,</span>
<span class="go">used to record only those changes done</span>
<span class="go">to the files listed with --output flags.</span>

<span class="go">EOT</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad save -m <span class="s2">&quot;add note on clean datasets&quot;</span>
<span class="go">add(ok): notes.txt (file)</span>
<span class="go">save(ok): . (dataset)</span>
<span class="go">action summary:</span>
<span class="go">  add (ok: 1)</span>
<span class="go">  save (ok: 1)</span>
</pre></div>
</div>
<p>To conclude this section on <strong class="command">datalad run</strong>, take a look at the last <strong class="command">datalad run</strong>
commit to see a <a class="reference internal" href="../glossary.html#term-run-record"><span class="xref std std-term">run record</span></a> with more content:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> git log -p -n <span class="m">2</span>
<span class="go">commit d9d087295ff9e7fc9369333098e277437b5b093e</span>
<span class="go">Author: Elena Piscopia &lt;elena@example.net&gt;</span>
<span class="go">Date:   Tue Nov 12 15:05:30 2019 +0100</span>

<span class="go">    [DATALAD RUNCMD] Resize logo for slides</span>
<span class="go">    </span>
<span class="go">    === Do not change lines below ===</span>
<span class="go">    {</span>
<span class="go">     &quot;chain&quot;: [],</span>
<span class="hll"><span class="go">     &quot;cmd&quot;: &quot;convert -resize 400x400 recordings/longnow/.datalad/feed_metadata/logo_salt.jpg recordings/salt_logo_small.jpg&quot;,</span>
</span><span class="go">     &quot;dsid&quot;: &quot;686444f8-0555-11ea-98f1-e86a64c8054c&quot;,</span>
<span class="go">     &quot;exit&quot;: 0,</span>
<span class="go">     &quot;extra_inputs&quot;: [],</span>
<span class="hll"><span class="go">     &quot;inputs&quot;: [</span>
</span><span class="hll"><span class="go">      &quot;recordings/longnow/.datalad/feed_metadata/logo_salt.jpg&quot;</span>
</span><span class="hll"><span class="go">     ],</span>
</span><span class="hll"><span class="go">     &quot;outputs&quot;: [</span>
</span><span class="hll"><span class="go">      &quot;recordings/salt_logo_small.jpg&quot;</span>
</span><span class="hll"><span class="go">     ],</span>
</span><span class="go">     &quot;pwd&quot;: &quot;.&quot;</span>
<span class="go">    }</span>
<span class="go">    ^^^ Do not change lines above ^^^</span>

<span class="go">diff --git a/recordings/salt_logo_small.jpg b/recordings/salt_logo_small.jpg</span>
<span class="go">index b6a0a1d..55ada0f 120000</span>
<span class="go">--- a/recordings/salt_logo_small.jpg</span>
<span class="go">+++ b/recordings/salt_logo_small.jpg</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>how to escape special characters</p></li>
</ul>
</div>
</div>
</div>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="101-110-run2.html" title="Previous document">Input and output</a>
        </li>
        <li>
          <a href="101-113-summary.html" title="Next document">Summary</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>