
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Input and output &#8212; The DataLad Handbook</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="canonical" href="http://handbook.datalad.org/basics/101-110-run2.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Clean desk" href="101-112-run4.html" />
    <link rel="prev" title="DataLad, Re-Run!" href="101-109-rerun.html" />
  

  

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    div.body {
      min-width: initial;
      max-width: initial;
    }
  </style>

  
  <link rel="canonical" href="https://handbook.datalad.org/basics/101-110-run2/"/>
  <meta property="og:url" content="https://handbook.datalad.org/basics/101-110-run2">
  

  <link rel="icon" type="image/png" href="https://media.readthedocs.org/images/favicon.png">

  <meta name="twitter:card" content="summary">
  <meta property="twitter:image" content="https://handbook.datalad.org/_static/social-card.jpg">
  <meta property="og:image" content="https://handbook.datalad.org/_static/social-card.jpg">
  <meta property="og:title" content="Input and output &#8212; The DataLad Handbook">
  <meta property="og:type" content="article">
  
  <meta property="og:description" content="">


  </head><body>
  <script type="text/javascript">

  $(window).scroll(function () {
    var s = $(window).scrollTop(),
          d = $(document).height(),
          c = $(window).height();
          scrollPercent = (s / (d-c)) * 100;
          var position = scrollPercent;

     $("#progressbar").attr('value', position);
  });
  </script>

  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" title="The DataLad Handbook"/>
  </a>
</p>

<p style="margin-left:auto; margin-right: auto;"><iframe src="https://ghbtns.com/github-btn.html?repo=book&user=datalad-handbook&type=star&count=true&size=large" allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe></p>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
<style>
.algolia-autocomplete{
  width: 100%;
  height: 1.5em
}
.algolia-autocomplete a{
  border-bottom: none !important;
}
#doc_search{
  width: 100%;
  height: 100%;
}
</style>

<progress id="progressbar" value="0" max="100"></progress>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Input and output</a><ul>
<li><a class="reference internal" href="#if-outputs-already-exist">If outputs already exist…</a></li>
<li><a class="reference internal" href="#placeholders">Placeholders</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="101-109-rerun.html" title="previous chapter">DataLad, Re-Run!</a></li>
      <li>Next: <a href="101-112-run4.html" title="next chapter">Clean desk</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><!-- Alabaster (krTheme++) Hacks -->
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            <div style="display:block;position:relative; margin-bottom: 1em;">
              <div style="display:block;width:100%;padding-top:12.5%;"></div>
              <div class="rpad" data-unit="8x1" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;"></div>
            </div>
            
  <div class="section" id="input-and-output">
<span id="run3"></span><h1>Input and output<a class="headerlink" href="#input-and-output" title="Permalink to this headline">¶</a></h1>
<p>In the previous two sections, you created a simple <code class="docutils literal notranslate"><span class="pre">.tsv</span></code> file of all
speakers and talk titles in the <code class="docutils literal notranslate"><span class="pre">longnow/</span></code> podcasts subdataset, and you have
re-executed a <strong class="command">datalad run</strong> command after a bug-fix in your script.</p>
<p>But these previous <strong class="command">datalad run</strong> and <strong class="command">datalad rerun</strong> command were very simple.
Maybe you noticed some values in the <code class="docutils literal notranslate"><span class="pre">run</span> <span class="pre">record</span></code> were empty:
<code class="docutils literal notranslate"><span class="pre">inputs</span></code> and <code class="docutils literal notranslate"><span class="pre">outputs</span></code> for example did not have an entry. Let’s experience
a few situations in which
these two arguments can become necessary.</p>
<p>In our DataLad-101 course we were given a group assignment. Everyone should
give a small presentation about an open DataLad dataset they found. Conveniently,
you decided to settle for the longnow podcasts right away.
After all, you know the dataset quite well already,
and after listening to almost a third of the podcasts
and enjoying them a lot,
you also want to recommend them to the others.</p>
<p>Almost all of the slides are ready, but what’s still missing is the logo of the
longnow podcasts. Good thing that this is part of the subdataset,
so you can simply retrieve it from there.</p>
<p>The logos (one for the SALT series, one for the Interval series – the two
directories in the subdataset)
were originally extracted from the podcasts metadata information by DataLad.
In a while, we will dive into the metadata aggregation capabilities of DataLad,
but for now, let’s just use the logos instead of finding out where they
come from – this will come later.
As part of the metadata of the dataset, the logos are
in the hidden paths
<code class="docutils literal notranslate"><span class="pre">.datalad/feed_metadata/logo_salt.jpg</span></code> and
<code class="docutils literal notranslate"><span class="pre">.datalad/feed_metadata/logo_interval.jpg</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ls recordings/longnow/.datalad/feed_metadata/*jpg
<span class="go">recordings/longnow/.datalad/feed_metadata/logo_interval.jpg</span>
<span class="go">recordings/longnow/.datalad/feed_metadata/logo_salt.jpg</span>
</pre></div>
</div>
<p>For the slides you decide to prepare images of size 400x400 px, but
the logos’ original size is much larger (both are 3000x3000 pixel). Therefore
let’s try to resize the images – currently, they’re far too large to fit on a slide.</p>
<p>To resize an image from the command line we can use the Unix
command <code class="docutils literal notranslate"><span class="pre">convert</span> <span class="pre">-resize</span></code> from the <a class="reference external" href="https://imagemagick.org/index.php">ImageMagick tool</a>.
The command takes a new size in pixels as an argument, a path to the file that should be
resized, and a filename and path under which a new,
resized image will be saved.
To resize one image to 400x400 px, the command would thus be
<code class="docutils literal notranslate"><span class="pre">convert</span> <span class="pre">-resize</span> <span class="pre">400x400</span> <span class="pre">path/to/file.jpg</span> <span class="pre">path/to/newfilename.jpg</span></code>.</p>
<p>Remembering the last lecture on <strong class="command">datalad run</strong>, you decide to plug this into
<strong class="command">datalad run</strong>. Even though this is not a script, it is a command, and you can wrap
commands like this conveniently with <strong class="command">datalad run</strong>.
Note that we line break the commands in the upcoming examples
for better readability – in your terminal, you can always write the commands into
a single line. The <code class="docutils literal notranslate"><span class="pre">\</span></code> are line breaks for your shell that make the commands work
when you copy them formatted like this.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad run -m <span class="s2">&quot;Resize logo for slides&quot;</span> <span class="se">\</span>
<span class="s2">&quot;convert -resize 400x400 recordings/longnow/.datalad/feed_metadata/logo_salt.jpg recordings/salt_logo_small.jpg&quot;</span>
<span class="go">[INFO] == Command start (output follows) ===== </span>
<span class="hll"><span class="go">convert-im6.q16: unable to open image `recordings/longnow/.datalad/feed_metadata/logo_salt.jpg&#39;: No such file or directory @ error/blob.c/OpenBlob/2874.</span>
</span><span class="go">convert-im6.q16: no images defined `recordings/salt_logo_small.jpg&#39; @ error/convert.c/ConvertImageCommand/3258.</span>
<span class="go">[INFO] == Command exit (modification check follows) ===== </span>
<span class="go">[INFO] The command had a non-zero exit code. If this is expected, you can save the changes with &#39;datalad save -d . -r -F .git/COMMIT_EDITMSG&#39; </span>
<span class="go">CommandError: command &#39;convert -resize 400x400 recordings/longnow/.datalad/feed_metadata/logo_salt.jpg recordings/salt_logo_small.jpg&#39; failed with exitcode 1</span>
<span class="go">Failed to run &#39;convert -resize 400x400 recordings/longnow/.datalad/feed_metadata/logo_salt.jpg recordings/salt_logo_small.jpg&#39; under &#39;/home/me/dl-101/DataLad-101&#39;. Exit code=1.</span>
</pre></div>
</div>
<p><em>Oh, crap!</em> Why didn’t this work?</p>
<p>Let’s take a look at the error message DataLad provides. In general, these error messages
might seem wordy, and maybe a bit intimidating as well, but usually they provide helpful
information to find out what is wrong. Whenever you encounter an error message,
make sure to read it, even if it feels like a mushroom cloud exploded in your terminal.</p>
<p>A <strong class="command">datalad run</strong> error message has several parts. The first starts after</p>
<p><code class="docutils literal notranslate"><span class="pre">[INFO</span>&#160;&#160; <span class="pre">]</span> <span class="pre">==</span> <span class="pre">Command</span> <span class="pre">start</span> <span class="pre">(output</span> <span class="pre">follows)</span> <span class="pre">=====</span></code>.</p>
<p>This is displaying errors that the
terminal command threw: The <code class="docutils literal notranslate"><span class="pre">convert</span></code> tool complains that it can not open
the file, because there is “No such file or directory”.</p>
<p>The second part starts after</p>
<p><code class="docutils literal notranslate"><span class="pre">[INFO</span>&#160;&#160; <span class="pre">]</span> <span class="pre">==</span> <span class="pre">Command</span> <span class="pre">exit</span> <span class="pre">(modification</span> <span class="pre">check</span> <span class="pre">follows)</span> <span class="pre">=====</span></code>.</p>
<p>DataLad adds information about a “non-zero exit code”. A non-zero exit code indicates
that something went wrong<a class="footnote-reference brackets" href="#f1" id="id1">1</a>. In principle, you could go ahead and google what this
specific exit status indicates. However, the solution might have already occurred to you when
reading the first error report: The file is not present.</p>
<p>How can that be?</p>
<p>“Right!”, you exclaim with a facepalm.
Just as the <code class="docutils literal notranslate"><span class="pre">.mp3</span></code> files, the <code class="docutils literal notranslate"><span class="pre">.jpg</span></code> file content is not present
locally after an install, and we did not <strong class="command">datalad get</strong> it yet!</p>
<p>This is where the <code class="docutils literal notranslate"><span class="pre">-i</span></code>/<code class="docutils literal notranslate"><span class="pre">--input</span></code> option for a datalad run becomes useful.
The content of everything that is specified as an <code class="docutils literal notranslate"><span class="pre">input</span></code> will be retrieved
prior to running the command.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad run -m <span class="s2">&quot;Resize logo for slides&quot;</span> <span class="se">\</span>
--input <span class="s2">&quot;recordings/longnow/.datalad/feed_metadata/logo_salt.jpg&quot;</span> <span class="se">\</span>
<span class="s2">&quot;convert -resize 400x400 recordings/longnow/.datalad/feed_metadata/logo_salt.jpg recordings/salt_logo_small.jpg&quot;</span>
<span class="gp">#</span> or shorter:
<span class="gp">$</span> datalad run -m <span class="s2">&quot;Resize logo for slides&quot;</span> <span class="se">\</span>
-i <span class="s2">&quot;recordings/longnow/.datalad/feed_metadata/logo_salt.jpg&quot;</span> <span class="se">\</span>
<span class="s2">&quot;convert -resize 400x400 recordings/longnow/.datalad/feed_metadata/logo_salt.jpg recordings/salt_logo_small.jpg&quot;</span>
<span class="hll"><span class="go">[INFO] Making sure inputs are available (this may take some time) </span>
</span><span class="go">[INFO] == Command start (output follows) ===== </span>
<span class="go">[INFO] == Command exit (modification check follows) ===== </span>
<span class="hll"><span class="go">get(ok): recordings/longnow/.datalad/feed_metadata/logo_salt.jpg (file) [from web...]</span>
</span><span class="go">add(ok): recordings/salt_logo_small.jpg (file)</span>
<span class="go">save(ok): . (dataset)</span>
<span class="go">action summary:</span>
<span class="go">  add (ok: 1)</span>
<span class="hll"><span class="go">  get (ok: 1)</span>
</span><span class="go">  save (notneeded: 1, ok: 1)</span>
</pre></div>
</div>
<p>Cool! You can see in this output that prior to the data command execution, DataLad did a <strong class="command">datalad get</strong>.
This is useful for several reasons. For one, it saved us the work of manually
getting content. But moreover, this is useful for anyone with whom we might share the
dataset: With an installed dataset one can very simply rerun <strong class="command">datalad run</strong> commands
if they have the input argument appropriately specified. It is therefore good practice to
specify the inputs appropriately. Remember from section <a class="reference internal" href="101-105-install.html#installds"><span class="std std-ref">Install datasets</span></a>
that <strong class="command">datalad get</strong> will only retrieve content if
it is not yet present, all input already downloaded will not be downloaded again – so
specifying inputs even though they are already present will not do any harm.</p>
<div class="toggle findoutmore docutils container">
<div class="header docutils container">
<p><strong>Find out more: </strong>What if there are several inputs?</p>
</div>
<p>Often, a command needs several inputs. In principle, every input gets its own <code class="docutils literal notranslate"><span class="pre">-i</span></code>/<code class="docutils literal notranslate"><span class="pre">--input</span></code>
flag. However, you can make use of <a class="reference internal" href="../glossary.html#term-globbing"><span class="xref std std-term">globbing</span></a>. For example,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>datalad run --input <span class="s2">&quot;*.jpg&quot;</span> <span class="s2">&quot;COMMAND&quot;</span>
</pre></div>
</div>
<p>will retrieve all <code class="docutils literal notranslate"><span class="pre">.jpg</span></code> files prior to command execution.</p>
</div>
<div class="section" id="if-outputs-already-exist">
<h2>If outputs already exist…<a class="headerlink" href="#if-outputs-already-exist" title="Permalink to this headline">¶</a></h2>
<p>Looking at the resulting image, you wonder whether 400x400 might be a tiny bit to small.
Maybe we should try to resize it to 450x450, and see whether that looks better?</p>
<p>Note that we can not use a <strong class="command">datalad rerun</strong> for this: if we want to change the dimension option
in the command, we have to define a new <strong class="command">datalad run</strong> command.</p>
<p>To establish best-practices, let’s specify the input even though it is already present:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad run -m <span class="s2">&quot;Resize logo for slides&quot;</span> <span class="se">\</span>
--input <span class="s2">&quot;recordings/longnow/.datalad/feed_metadata/logo_salt.jpg&quot;</span> <span class="se">\</span>
<span class="s2">&quot;convert -resize 450x450 recordings/longnow/.datalad/feed_metadata/logo_salt.jpg recordings/salt_logo_small.jpg&quot;</span>
<span class="gp">#</span> or shorter:
<span class="gp">$</span> datalad run -m <span class="s2">&quot;Resize logo for slides&quot;</span> <span class="se">\</span>
-i <span class="s2">&quot;recordings/longnow/.datalad/feed_metadata/logo_salt.jpg&quot;</span> <span class="se">\</span>
<span class="s2">&quot;convert -resize 450x450 recordings/longnow/.datalad/feed_metadata/logo_salt.jpg recordings/salt_logo_small.jpg&quot;</span>
<span class="go">[INFO] Making sure inputs are available (this may take some time) </span>
<span class="go">[INFO] == Command start (output follows) ===== </span>
<span class="hll"><span class="go">convert-im6.q16: unable to open image `recordings/salt_logo_small.jpg&#39;: Permission denied @ error/blob.c/OpenBlob/2874.</span>
</span><span class="go">[INFO] == Command exit (modification check follows) ===== </span>
<span class="go">[INFO] The command had a non-zero exit code. If this is expected, you can save the changes with &#39;datalad save -d . -r -F .git/COMMIT_EDITMSG&#39; </span>
<span class="go">CommandError: command &#39;convert -resize 450x450 recordings/longnow/.datalad/feed_metadata/logo_salt.jpg recordings/salt_logo_small.jpg&#39; failed with exitcode 1</span>
<span class="go">Failed to run &#39;convert -resize 450x450 recordings/longnow/.datalad/feed_metadata/logo_salt.jpg recordings/salt_logo_small.jpg&#39; under &#39;/home/me/dl-101/DataLad-101&#39;. Exit code=1.</span>
</pre></div>
</div>
<p><strong>Oh wtf</strong>… <em>What is it now?</em></p>
<p>A quick glimpse into the error message shows a different error than before:
The tool complains that it is “unable to open” the image, because the “Permission [is] denied”.</p>
<p>We have not seen anything like this before, and we need to turn to our lecturer for help.
Confused about what we might have
done wrong, we raise our hand to ask the instructor for help.
Knowingly, she smiles, and tells you about how DataLad protects content given
to it:</p>
<p>“Content in your DataLad dataset is protected by <a class="reference internal" href="../glossary.html#term-git-annex"><span class="xref std std-term">Git-annex</span></a> from
accidental changes” our instructor begins.</p>
<p>“Wait!” we interrupt. “First of, that wasn’t accidental. And second, I was told this
course does not have <code class="docutils literal notranslate"><span class="pre">Git-annex-101</span></code> as a prerequisite?”</p>
<p>“Yes, hear me out” she says. “I promise you two different solutions at
the end of this explanation, and the concept behind this is quite relevant”.</p>
<p>DataLad usually gives content to <a class="reference internal" href="../glossary.html#term-git-annex"><span class="xref std std-term">Git-annex</span></a> to store and track.
Git-annex, let’s just say, takes this task <em>really</em> seriously. One of its
features that you have just experienced is that it <em>locks</em> content.</p>
<p>If files are <em>locked down</em>, their content can not be modified. In principle,
that’s not a bad thing: It could be your late grandma’s secret cherry-pie
recipe, and you do not want to <em>accidentally</em> change that.
Therefore, a file needs to be consciously <em>unlocked</em> to apply modifications.</p>
<p>In the attempt to resize the image to 450x450 you tried to overwrite
<code class="docutils literal notranslate"><span class="pre">recordings/salt_logo_small.jpg</span></code>, a file that was given to DataLad
and thus protected by Git-annex.</p>
<p id="index-0">There is a DataLad command that takes care of unlocking file content,
and thus making locked files modifiable again: <strong class="command">datalad unlock</strong>
(<em class="manpage"><a class="manpage reference external" href="http://docs.datalad.org/generated/man/datalad-unlock.html">datalad-unlock</a></em> manual).
Let us check out what it does:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad unlock recordings/salt_logo_small.jpg
<span class="go">unlock(ok): recordings/salt_logo_small.jpg (file)</span>
</pre></div>
</div>
<p>Well, <code class="docutils literal notranslate"><span class="pre">unlock(ok)</span></code> does not sound too bad for a start. As always, we
feel the urge to run a <strong class="command">datalad status</strong> on this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad status
<span class="go"> modified: recordings/salt_logo_small.jpg (symlink)</span>
</pre></div>
</div>
<p>“Ah, do not mind that for now”, our instructor says, and with a wink she
continues: “We’ll talk about symlinks and object trees a while later”.
We’re not really sure whether that’s a good thing, but we have a task to focus
on. Hastily, you run the command right from the terminal:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> convert -resize 450x450 recordings/longnow/.datalad/feed_metadata/logo_salt.jpg recordings/salt_logo_small.jpg
</pre></div>
</div>
<p>Hey, no permission denied error! You note that the instructor still stands
right next to you. “Sooo… now what do I do to <em>lock</em> the file again?” you ask.</p>
<p>“Well… what you just did there was quite suboptimal. Didn’t you want to
use <strong class="command">datalad run</strong>? But, anyway, in order to lock the file again, you would need to
run a <strong class="command">datalad save</strong>.”</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad save -m <span class="s2">&quot;resized picture by hand&quot;</span>
<span class="go">add(ok): recordings/salt_logo_small.jpg (file)</span>
<span class="go">save(ok): . (dataset)</span>
<span class="go">action summary:</span>
<span class="go">  add (ok: 1)</span>
<span class="go">  save (ok: 1)</span>
</pre></div>
</div>
<p>“So”, you wonder aloud, “whenever I want to modify I need to
<strong class="command">datalad unlock</strong> it, do the modifications, and then <strong class="command">datalad save</strong> it?”</p>
<p>“Well, this is certainly one way of doing it, and a completely valid workflow
if you would do that outside of a <strong class="command">datalad run</strong> command.
But within <strong class="command">datalad run</strong> there is actually a much easier way of doing this.
Let’s use the <code class="docutils literal notranslate"><span class="pre">--output</span></code> argument.”</p>
<p><strong class="command">datalad run</strong> <em>retrieves</em> everything that is specified as <code class="docutils literal notranslate"><span class="pre">--input</span></code> prior to
command execution, and it <em>unlocks</em> everything specified as <code class="docutils literal notranslate"><span class="pre">--output</span></code> prior to
command execution. Therefore, whenever the output of a <strong class="command">datalad run</strong> command already
exists and is tracked, it should be specified as an argument in
the <code class="docutils literal notranslate"><span class="pre">-o</span></code>/<code class="docutils literal notranslate"><span class="pre">--output</span></code> option.</p>
<div class="toggle findoutmore docutils container">
<div class="header docutils container">
<p><strong>Find out more: </strong>But what if I have a lot of outputs?</p>
</div>
<p>The use case here is simplistic – a single file gets modified.
But there are commands and tools that create full directories with
many files as an output, for example
<a class="reference external" href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki">FSL</a>, a neuro-imaging tool.
The easiest way to specify this type of output
is the directory name and a <a class="reference internal" href="../glossary.html#term-globbing"><span class="xref std std-term">globbing</span></a> character, such as
<code class="docutils literal notranslate"><span class="pre">-o</span> <span class="pre">directory/*</span></code></p>
</div>
<p>In order to execute <strong class="command">datalad run</strong> with both the <code class="docutils literal notranslate"><span class="pre">-i</span></code>/<code class="docutils literal notranslate"><span class="pre">--input</span></code> and <code class="docutils literal notranslate"><span class="pre">-o</span></code>/<code class="docutils literal notranslate"><span class="pre">--output</span></code>
flag and see their magic, let’s crop the second logo, <code class="docutils literal notranslate"><span class="pre">logo_interval.jpg</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad run -m <span class="s2">&quot;Resize logo for slides&quot;</span> <span class="se">\</span>
--input <span class="s2">&quot;recordings/longnow/.datalad/feed_metadata/logo_interval.jpg&quot;</span> <span class="se">\</span>
--output <span class="s2">&quot;recordings/interval_logo_small.jpg&quot;</span> <span class="se">\</span>
<span class="s2">&quot;convert -resize 450x450 recordings/longnow/.datalad/feed_metadata/logo_interval.jpg recordings/interval_logo_small.jpg&quot;</span>

<span class="gp">#</span> or shorter:
<span class="gp">$</span> datalad run -m <span class="s2">&quot;Resize logo for slides&quot;</span> <span class="se">\</span>
-i <span class="s2">&quot;recordings/longnow/.datalad/feed_metadata/logo_interval.jpg&quot;</span> <span class="se">\</span>
-o <span class="s2">&quot;recordings/interval_logo_small.jpg&quot;</span> <span class="se">\</span>
<span class="s2">&quot;convert -resize 450x450 recordings/longnow/.datalad/feed_metadata/logo_interval.jpg recordings/interval_logo_small.jpg&quot;</span>
<span class="go">[INFO] Making sure inputs are available (this may take some time) </span>
<span class="go">[INFO] == Command start (output follows) ===== </span>
<span class="go">[INFO] == Command exit (modification check follows) ===== </span>
<span class="hll"><span class="go">get(ok): recordings/longnow/.datalad/feed_metadata/logo_interval.jpg (file) [from web...]</span>
</span><span class="go">add(ok): recordings/interval_logo_small.jpg (file)</span>
<span class="go">save(ok): . (dataset)</span>
<span class="go">action summary:</span>
<span class="go">  add (ok: 1)</span>
<span class="hll"><span class="go">  get (ok: 1)</span>
</span><span class="go">  save (notneeded: 1, ok: 1)</span>
</pre></div>
</div>
<p>This time, with both <code class="docutils literal notranslate"><span class="pre">--input</span></code> and <code class="docutils literal notranslate"><span class="pre">--output</span></code>
options specified, DataLad informs about the <strong class="command">datalad get</strong>
operations it performs prior to the command
execution, and <strong class="command">datalad run</strong> executes the command successfully.
It does <em>not</em> inform about any <strong class="command">datalad unlock</strong> operation,
because the output <code class="docutils literal notranslate"><span class="pre">recordings/interval_logo_small.jpg</span></code> does not
exist before the command is run. Should you rerun this command however,
the summary will include a statement about content unlocking. You will
see an example of this in the next section.</p>
<p>Note now how many individual commands a <strong class="command">datalad run</strong> saves us:
<strong class="command">datalad get</strong>, <strong class="command">datalad unlock</strong>, and <strong class="command">datalad save</strong>!</p>
<p>With this last code snippet, you have experienced a full <strong class="command">datalad run</strong> command: commit message,
input and output definitions (the order in which you give those two options is irrelevant),
and the command to be executed. Whenever a command takes input or produces output you should specify
this with the appropriate option.</p>
<p>Make a note of this behavior in your <code class="docutils literal notranslate"><span class="pre">notes.txt</span></code> file.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cat &lt;&lt; EOT &gt;&gt; notes.txt
<span class="go">You should specify all files that a command takes as input with an -i/--input flag. These</span>
<span class="go">files will be retrieved prior to the command execution. Any content that is modified or</span>
<span class="go">produced by the command should be specified with an -o/--output flag. Upon a run or rerun</span>
<span class="go">of the command, the contents of these files will get unlocked so that they can be modified.</span>

<span class="go">EOT</span>
</pre></div>
</div>
</div>
<div class="section" id="placeholders">
<h2>Placeholders<a class="headerlink" href="#placeholders" title="Permalink to this headline">¶</a></h2>
<p>Just after writing this note, you have to relax your fingers a bit. “Man, this was
so much typing. Not only did I need to specify the inputs and outputs, I also had
to repeat all of these lengthy paths in the command line call…” you think.</p>
<p>There is a neat little trick to spare you half of this typing effort, though: <em>Placeholders</em>
for inputs and outputs. This is how it works:</p>
<p>Instead of running</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ datalad run -m <span class="s2">&quot;Resize logo for slides&quot;</span> <span class="se">\</span>
--input <span class="s2">&quot;recordings/longnow/.datalad/feed_metadata/logo_interval.jpg&quot;</span> <span class="se">\</span>
--output <span class="s2">&quot;recordings/interval_logo_small.jpg&quot;</span> <span class="se">\</span>
<span class="s2">&quot;convert -resize 450x450 recordings/longnow/.datalad/feed_metadata/logo_interval.jpg recordings/interval_logo_small.jpg&quot;</span>
</pre></div>
</div>
<p>you could shorten this to</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ datalad run -m <span class="s2">&quot;Resize logo for slides&quot;</span> <span class="se">\</span>
--input <span class="s2">&quot;recordings/longnow/.datalad/feed_metadata/logo_interval.jpg&quot;</span> <span class="se">\</span>
--output <span class="s2">&quot;recordings/interval_logo_small.jpg&quot;</span> <span class="se">\</span>
<span class="hll"><span class="s2">&quot;convert -resize 450x450 {inputs} {outputs}&quot;</span>
</span></pre></div>
</div>
<p>The placeholder <code class="docutils literal notranslate"><span class="pre">{inputs}</span></code> will expand to the path given as <code class="docutils literal notranslate"><span class="pre">--input</span></code>, and
the placeholder <code class="docutils literal notranslate"><span class="pre">{outputs}</span></code> will expand to the path given as <code class="docutils literal notranslate"><span class="pre">--output</span></code>.
This means instead of writing the full paths in the command, you can simply reuse
the <code class="docutils literal notranslate"><span class="pre">--input</span></code> and <code class="docutils literal notranslate"><span class="pre">--output</span></code> specification done before.</p>
<div class="toggle findoutmore docutils container">
<div class="header docutils container">
<p><strong>Find out more: </strong>What if I have multiple inputs or outputs?</p>
</div>
<p>If multiple values are specified, e.g., as in</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ datalad run -m <span class="s2">&quot;move a few files around&quot;</span> <span class="se">\</span>
--input <span class="s2">&quot;file1&quot;</span> --input <span class="s2">&quot;file2&quot;</span> --input <span class="s2">&quot;file3&quot;</span> <span class="se">\</span>
--output <span class="s2">&quot;directory_a/&quot;</span> <span class="se">\</span>
<span class="s2">&quot;mv {inputs} {outputs}&quot;</span>
</pre></div>
</div>
<p>the values will be joined by a space like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ datalad run -m <span class="s2">&quot;move a few files around&quot;</span> <span class="se">\</span>
--input <span class="s2">&quot;file1&quot;</span> --input <span class="s2">&quot;file2&quot;</span> --input <span class="s2">&quot;file3&quot;</span> <span class="se">\</span>
--output <span class="s2">&quot;directory_a/&quot;</span> <span class="se">\</span>
<span class="s2">&quot;mv file1 file2 file3 directory_a}&quot;</span>
</pre></div>
</div>
<p>The order of the values will match that order from the command line.</p>
<p>If you use globs for input specification, as in</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ datalad run -m <span class="s2">&quot;move a few files around&quot;</span> <span class="se">\</span>
--input <span class="s2">&quot;file*&quot;</span> <span class="se">\</span>
--output <span class="s2">&quot;directory_a/&quot;</span> <span class="se">\</span>
<span class="s2">&quot;mv {inputs} {outputs}&quot;</span>
</pre></div>
</div>
<p>the globs will expanded in alphabetical order (like bash):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ datalad run -m <span class="s2">&quot;move a few files around&quot;</span> <span class="se">\</span>
--input <span class="s2">&quot;file1&quot;</span> --input <span class="s2">&quot;file2&quot;</span> --input <span class="s2">&quot;file3&quot;</span> <span class="se">\</span>
--output <span class="s2">&quot;directory_a/&quot;</span> <span class="se">\</span>
<span class="s2">&quot;mv file1 file2 file3 directory_a}&quot;</span>
</pre></div>
</div>
<p>If the command only needs a subset of the inputs or outputs, individual values
can be accessed with an integer index, e.g., <code class="docutils literal notranslate"><span class="pre">{inputs[0]}</span></code> for the very first
input.</p>
</div>
<div class="toggle findoutmore docutils container">
<div class="header docutils container">
<p><strong>Find out more: </strong>… wait, what if I need a { or } character in my datalad run call?</p>
</div>
<p>If your command call involves a <code class="docutils literal notranslate"><span class="pre">{</span></code> or <code class="docutils literal notranslate"><span class="pre">}</span></code> character, you will need to escape
this brace character by doubling it, i.e., <code class="docutils literal notranslate"><span class="pre">{{</span></code> or <code class="docutils literal notranslate"><span class="pre">}}</span></code>.</p>
</div>
<dl class="footnote brackets">
<dt class="label" id="f1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>In shell programming, commands exit with a specific code that indicates
whether they failed, and if so, how. Successful commands have the exit code zero. All failures
have exit codes greater than zero. A few lines lower, DataLad even tells us the specific error
code: The command failed with exit code 1.</p>
</dd>
</dl>
</div>
</div>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="101-109-rerun.html" title="Previous document">DataLad, Re-Run!</a>
        </li>
        <li>
          <a href="101-112-run4.html" title="Next document">Clean desk</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>