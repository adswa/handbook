
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>More on DIY configurations &#8212; The DataLad Handbook</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="canonical" href="http://handbook.datalad.org/basics/101-126-config2.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Configurations to go" href="101-127-procedures.html" />
    <link rel="prev" title="DIY configurations" href="101-125-config.html" />
  

  

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    div.body {
      min-width: initial;
      max-width: initial;
    }
  </style>

  
  <link rel="canonical" href="https://handbook.datalad.org/basics/101-126-config2/"/>
  <meta property="og:url" content="https://handbook.datalad.org/basics/101-126-config2">
  

  <link rel="icon" type="image/png" href="https://media.readthedocs.org/images/favicon.png">

  <meta name="twitter:card" content="summary">
  <meta property="twitter:image" content="https://handbook.datalad.org/_static/social-card.jpg">
  <meta property="og:image" content="https://handbook.datalad.org/_static/social-card.jpg">
  <meta property="og:title" content="More on DIY configurations &#8212; The DataLad Handbook">
  <meta property="og:type" content="article">
  
  <meta property="og:description" content="">


  </head><body>
  <script type="text/javascript">

  $(window).scroll(function () {
    var s = $(window).scrollTop(),
          d = $(document).height(),
          c = $(window).height();
          scrollPercent = (s / (d-c)) * 100;
          var position = scrollPercent;

     $("#progressbar").attr('value', position);
  });
  </script>

  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" title="The DataLad Handbook"/>
  </a>
</p>

<p style="margin-left:auto; margin-right: auto;"><iframe src="https://ghbtns.com/github-btn.html?repo=book&user=datalad-handbook&type=star&count=true&size=large" allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe></p>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
<style>
.algolia-autocomplete{
  width: 100%;
  height: 1.5em
}
.algolia-autocomplete a{
  border-bottom: none !important;
}
#doc_search{
  width: 100%;
  height: 100%;
}
</style>

<progress id="progressbar" value="0" max="100"></progress>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">More on DIY configurations</a><ul>
<li><a class="reference internal" href="#gitattributes"><code class="docutils literal notranslate"><span class="pre">.gitattributes</span></code></a></li>
<li><a class="reference internal" href="#gitmodules"><code class="docutils literal notranslate"><span class="pre">.gitmodules</span></code></a></li>
<li><a class="reference internal" href="#datalad-config"><code class="docutils literal notranslate"><span class="pre">.datalad/config</span></code></a></li>
<li><a class="reference internal" href="#writing-to-configuration-files-other-than-git-config">Writing to configuration files other than <code class="docutils literal notranslate"><span class="pre">.git/config</span></code></a></li>
<li><a class="reference internal" href="#environment-variables">Environment variables</a></li>
<li><a class="reference internal" href="#summary">Summary</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="101-125-config.html" title="previous chapter">DIY configurations</a></li>
      <li>Next: <a href="101-127-procedures.html" title="next chapter">Configurations to go</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><!-- Alabaster (krTheme++) Hacks -->
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            <div style="display:block;position:relative; margin-bottom: 1em;">
              <div style="display:block;width:100%;padding-top:12.5%;"></div>
              <div class="rpad" data-unit="8x1" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;"></div>
            </div>
            
  <div class="section" id="more-on-diy-configurations">
<span id="config2"></span><h1>More on DIY configurations<a class="headerlink" href="#more-on-diy-configurations" title="Permalink to this headline">¶</a></h1>
<p>As the last section already suggest, within a Git repository,
<code class="docutils literal notranslate"><span class="pre">.git/config</span></code> is not the only configuration file.
There are also <code class="docutils literal notranslate"><span class="pre">.gitmodules</span></code> and <code class="docutils literal notranslate"><span class="pre">.gitattributes</span></code>, and in DataLad datasets
there also is a <code class="docutils literal notranslate"><span class="pre">.datalad/config</span></code> file.</p>
<p>All of these files store configurations, but have an important difference:
They are version controlled, and upon sharing a dataset these configurations
will be shared as well. An example for a shared configuration
is the one that the <code class="docutils literal notranslate"><span class="pre">text2git</span></code> configuration template applied:
In the shared copy of your dataset, text files are also saved with Git,
and not Git-annex (see section <a class="reference internal" href="101-121-siblings.html#sibling"><span class="std std-ref">Networking</span></a>). The configuration responsible
for this behavior is in a <code class="docutils literal notranslate"><span class="pre">.gitattributes</span></code> file, and we’ll start this
section by looking into it.</p>
<div class="section" id="gitattributes">
<h2><code class="docutils literal notranslate"><span class="pre">.gitattributes</span></code><a class="headerlink" href="#gitattributes" title="Permalink to this headline">¶</a></h2>
<p>This file lies right in the root of your superdataset:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cat .gitattributes

<span class="go">* annex.backend=MD5E</span>
<span class="go">**/.git* annex.largefiles=nothing</span>
<span class="go">* annex.largefiles=(not(mimetype=text/*)and(largerthan=0))</span>
</pre></div>
</div>
<p>This looks neither spectacular nor pretty. Also, it does not follow the <code class="docutils literal notranslate"><span class="pre">section-option-value</span></code>
organization of the <code class="docutils literal notranslate"><span class="pre">.git/config</span></code> file anymore. Instead, there are three lines,
and all of these seem to have something to do with the configuration of Git-annex.
There even is one key word that you recognize: MD5E.
If you have read the hidden section in <a class="reference internal" href="101-115-symlinks.html#symlink"><span class="std std-ref">Data integrity</span></a>
you will recognize it as a reference to the type of
key used by Git-annex to identify and store file content in the object-tree.
The first row, <code class="docutils literal notranslate"><span class="pre">*</span> <span class="pre">annex.backend=MD5E</span></code>, therefore translates to “Everything in this
directory should be hashed with a MD5E hash function”.
But what is the rest? We’ll start with the last row:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">annex</span><span class="o">.</span><span class="n">largefiles</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span><span class="p">(</span><span class="n">mimetype</span><span class="o">=</span><span class="n">text</span><span class="o">/*</span><span class="p">))</span>
</pre></div>
</div>
<p>Uhhh, cryptic. The lecturer explains:</p>
<p>“Git-annex will <em>annex</em>, that is, <em>store in the object-tree</em>,
anything it considers to be a “large file”. By default, anything
in your dataset would be a “large file”, that means anything would be annexed.
However, in section <a class="reference internal" href="101-115-symlinks.html#symlink"><span class="std std-ref">Data integrity</span></a> I already mentioned that exceptions to this
behavior can be defined based on</p>
<ol class="arabic simple">
<li><p>file size</p></li>
<li><p>and/or path/pattern, and thus for example file extensions,
or names, or file types (e.g., text files, as with the
<code class="docutils literal notranslate"><span class="pre">text2git</span></code> configuration template).</p></li>
</ol>
<p>“In <code class="docutils literal notranslate"><span class="pre">.gitattributes</span></code>, you can define what a large file and what is not
by simply telling Git-annex by writing such rules.”</p>
<p>What you can see in this <code class="docutils literal notranslate"><span class="pre">.gitattribute</span></code> file is a rule based on <strong>file types</strong>:
With <code class="docutils literal notranslate"><span class="pre">(not(mimetype=text/*))</span></code><a class="footnote-reference brackets" href="#f1" id="id1">1</a>, the <code class="docutils literal notranslate"><span class="pre">text2git</span></code> configuration template
configured Git-annex to regard all files of type text <strong>not</strong> as a large file.
Thanks to this little line, your text files are not annexed, but stored
directly in Git.</p>
<p>The patterns <code class="docutils literal notranslate"><span class="pre">*</span></code> and <code class="docutils literal notranslate"><span class="pre">**</span></code> are so-called “wildcards” used in <a class="reference internal" href="../glossary.html#term-globbing"><span class="xref std std-term">globbing</span></a>.
<code class="docutils literal notranslate"><span class="pre">*</span></code> matches any file or directory in the current directory, and <code class="docutils literal notranslate"><span class="pre">**</span></code> matches
all files and directories in the current directory <em>and subdirectories</em>. In technical
terms, <code class="docutils literal notranslate"><span class="pre">**</span></code> matches <em>recursively</em>. The third row therefore
translates to “Do not annex anything that is a text file in this directory” for Git-annex.</p>
<p>However, rules can be even simpler. The second row simply takes a complete directory
(<code class="docutils literal notranslate"><span class="pre">.git</span></code>) and instructs Git-annex to regard nothing in it as a “large file”.
The second row, <code class="docutils literal notranslate"><span class="pre">**/.git*</span> <span class="pre">annex.largefiles=nothing</span></code> therefore means that no
<code class="docutils literal notranslate"><span class="pre">.git</span></code> repository in this directory or a subdirectory should be considered
a “large file”. This way, the <code class="docutils literal notranslate"><span class="pre">.git</span></code> repositories are protected from being annexed.
If you had a single file (<code class="docutils literal notranslate"><span class="pre">myfile.pdf</span></code>) you would not want annexed, specifying a rule such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myfile</span><span class="o">.</span><span class="n">pdf</span> <span class="n">annex</span><span class="o">.</span><span class="n">largefiles</span><span class="o">=</span><span class="n">nothing</span>
</pre></div>
</div>
<p>will keep it stored in Git. To see an example of this, navigate into the longnow subdataset,
and view this dataset’s <code class="docutils literal notranslate"><span class="pre">.gitattributes</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cat recordings/longnow/.gitattributes
<span class="go">* annex.backend=MD5E</span>
<span class="go">**/.git* annex.largefiles=nothing</span>
<span class="go">README.md annex.largefiles=nothing</span>
</pre></div>
</div>
<p>The relevant part is <code class="docutils literal notranslate"><span class="pre">README.md</span> <span class="pre">annex.largefiles=nothing</span></code>.
This instructs Git-annex to specifically not annex <code class="docutils literal notranslate"><span class="pre">README.md</span></code>.</p>
<p>Lastly, if you wanted to configure a rule based on <strong>size</strong>, you could add a row such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">**</span> <span class="n">annex</span><span class="o">.</span><span class="n">largefiles</span><span class="p">(</span><span class="n">largerthan</span><span class="o">=</span><span class="mi">20</span><span class="n">kb</span><span class="p">)</span>
</pre></div>
</div>
<p>to store only files exceeding 20KB in size in Git-annex<a class="footnote-reference brackets" href="#f2" id="id2">2</a>.</p>
<p>As you may have noticed, unlike <code class="docutils literal notranslate"><span class="pre">.git/config</span></code> files,
there can be multiple <code class="docutils literal notranslate"><span class="pre">.gitattributes</span></code> files within a dataset. So far, you have seen one
in the root of the superdataset, and in the root of the <code class="docutils literal notranslate"><span class="pre">longnow</span></code> subdataset.
In principle, you can add one to every directory-level of your dataset.
For example, there is another <code class="docutils literal notranslate"><span class="pre">.gitattributes</span></code> file within the
<code class="docutils literal notranslate"><span class="pre">.datalad</span></code> directory:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cat .datalad/.gitattributes

<span class="go">config annex.largefiles=nothing</span>
<span class="go">metadata/aggregate* annex.largefiles=nothing</span>
<span class="go">metadata/objects/** annex.largefiles=(anything)</span>
</pre></div>
</div>
<p>As with Git configuration files, more specific or lower-level configurations take precedence
over more general or higher-level configurations. Specifications in a subdirectory can
therefore overrule specifications made in the <code class="docutils literal notranslate"><span class="pre">.gitattributes</span></code> file of the parent
directory.</p>
<p>In summary, the <code class="docutils literal notranslate"><span class="pre">.gitattributes</span></code> files will give you the possibility to configure
what should be annexed and what should not be annexed up to individual file level.
This can be very handy, and allows you to tune your dataset to your custom needs.
For example, files you will often edit by hand could be stored in Git if they are
not too large to ease modifying them<a class="footnote-reference brackets" href="#f3" id="id3">3</a>.
Once you know the basics of this type of configuration syntax, writing
your own rules is easy. For more tips on how configure Git-annex’s content
management in <code class="docutils literal notranslate"><span class="pre">.gitattributes</span></code>, take a look at <a class="reference external" href="https://git-annex.branchable.com/tips/largefiles/">this</a>
page of the Git-annex documentation.
Later however you will see preconfigured DataLad <em>procedures</em> such as <code class="docutils literal notranslate"><span class="pre">text2git</span></code> that
can apply useful configurations for you, just as <code class="docutils literal notranslate"><span class="pre">text2git</span></code> added the last line
in the root <code class="docutils literal notranslate"><span class="pre">.gitattributes</span></code> file.</p>
</div>
<div class="section" id="gitmodules">
<h2><code class="docutils literal notranslate"><span class="pre">.gitmodules</span></code><a class="headerlink" href="#gitmodules" title="Permalink to this headline">¶</a></h2>
<p>On last configuration file we want to look at is the <code class="docutils literal notranslate"><span class="pre">.gitmodules</span></code> file.
There is one right in the root of your dataset:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cat .gitmodules
<span class="go">[submodule &quot;recordings/longnow&quot;]</span>
<span class="go">	path = recordings/longnow</span>
<span class="go">	url = https://github.com/datalad-datasets/longnow-podcasts.git</span>
<span class="go">	datalad-id = b3ca2718-8901-11e8-99aa-a0369f7c647e</span>
</pre></div>
</div>
<p>Based on these contents, you might have already guessed what this file
stores. <code class="docutils literal notranslate"><span class="pre">.gitmodules</span></code> is a configuration file that stores the mapping between
your own dataset and any subdatasets you have installed in it.
There will be an entry for each submodule (subdataset) in your dataset.
The name <em>submodule</em> is Git terminology, and describes a Git repository inside of
another Git repository, i.e., the super- and subdataset principles.
Upon sharing your dataset, the information about subdatasets and where to retrieve
them from is stored and shared with this file.</p>
</div>
<div class="section" id="datalad-config">
<h2><code class="docutils literal notranslate"><span class="pre">.datalad/config</span></code><a class="headerlink" href="#datalad-config" title="Permalink to this headline">¶</a></h2>
<p>DataLad adds a repository-specific configuration file as well.
It can be found in the <code class="docutils literal notranslate"><span class="pre">.datalad</span></code> directory, and just like <code class="docutils literal notranslate"><span class="pre">.gitattributes</span></code>
and <code class="docutils literal notranslate"><span class="pre">.gitmodules</span></code> it is version controlled and is thus shared together with
the dataset. One can configure
<a class="reference external" href="http://docs.datalad.org/en/latest/generated/datalad.config.html">many options</a>,
but currently, our <code class="docutils literal notranslate"><span class="pre">.datalad/config</span></code> file only stores a dataset ID:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cat .datalad/config
<span class="go">[datalad &quot;dataset&quot;]</span>
<span class="go">	id = 686444f8-0555-11ea-98f1-e86a64c8054c</span>
</pre></div>
</div>
<p>Note, though, that local configurations within a Git configuration file
will take precedence over configurations that can be distributed with a dataset.
Otherwise, dataset updates with <strong class="command">datalad update</strong> (or, for Git-users,
<strong class="command">git pull</strong>) could suddenly and unintentionally alter local DataLad
behavior that was specifically configured.</p>
</div>
<div class="section" id="writing-to-configuration-files-other-than-git-config">
<h2>Writing to configuration files other than <code class="docutils literal notranslate"><span class="pre">.git/config</span></code><a class="headerlink" href="#writing-to-configuration-files-other-than-git-config" title="Permalink to this headline">¶</a></h2>
<p>“Didn’t you say that knowing git <strong class="command">git config</strong> command is already
half of what I need to know?” you ask. “Now there are three other configuration
files, and I do not know with which command I can write into these files.”</p>
<p>“Excellent question”, you hear in return, “but in reality, you <strong>do</strong> know:
it’s also the <strong class="command">git config</strong> command. The only part of it you need to
adjust is the <code class="docutils literal notranslate"><span class="pre">-f</span></code>, <code class="docutils literal notranslate"><span class="pre">--file</span></code> parameter. By default, the command writes to
a Git config file. But it can write to a different file if you specify it
appropriately. For example</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">config</span> <span class="pre">--file=.gitmodules</span> <span class="pre">--replace-all</span> <span class="pre">submodule.&quot;name&quot;.url</span> <span class="pre">&quot;new</span> <span class="pre">URL&quot;</span></code></p>
</div></blockquote>
<p>will update your submodule’s URL. Keep in mind though that you would need
to commit this change, as <code class="docutils literal notranslate"><span class="pre">.gitmodules</span></code> is version controlled”.</p>
<p>Let’s try this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> git config --file<span class="o">=</span>.gitmodules --replace-all submodule.<span class="s2">&quot;recordings/longnow&quot;</span>.url <span class="s2">&quot;git@github.com:datalad-datasets/longnow-podcasts.git&quot;</span>
</pre></div>
</div>
<p>This command will replace the submodule’s https URL with an SSH URL.
The later is often used if someone has an <em>SSH key pair</em> and added the
public key to their Github account (you can read more about this
<a class="reference external" href="https://help.github.com/en/articles/which-remote-url-should-i-use">here</a>).
We will revert this change shortly, but use it to show the difference between
a <strong class="command">git config</strong> on a <code class="docutils literal notranslate"><span class="pre">.git/config</span></code> file and on a version controlled file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad status
<span class="go"> modified: .gitmodules (file)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> git diff
<span class="go">diff --git a/.gitmodules b/.gitmodules</span>
<span class="go">index 1b59b8c..599864e 100644</span>
<span class="go">--- a/.gitmodules</span>
<span class="go">+++ b/.gitmodules</span>
<span class="go">@@ -1,4 +1,4 @@</span>
<span class="go"> [submodule &quot;recordings/longnow&quot;]</span>
<span class="go"> 	path = recordings/longnow</span>
<span class="go">-	url = https://github.com/datalad-datasets/longnow-podcasts.git</span>
<span class="go">+	url = git@github.com:datalad-datasets/longnow-podcasts.git</span>
<span class="go"> 	datalad-id = b3ca2718-8901-11e8-99aa-a0369f7c647e</span>
</pre></div>
</div>
<p>As these two commands show, the <code class="docutils literal notranslate"><span class="pre">.gitmodules</span></code> file is modified. The https URL
has been deleted (note the <code class="docutils literal notranslate"><span class="pre">-</span></code>, and a SSH URL has been added. To keep these
changes, we would need to <strong class="command">datalad save</strong> them. However, as we want to stay with
https URLs, we will just <em>checkout</em> this change – using a Git tool to undo an
unstaged modification.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> git checkout .gitmodules
<span class="gp">$</span> datalad status
</pre></div>
</div>
<p>Note, though, that the <code class="docutils literal notranslate"><span class="pre">.gitattributes</span></code> file can not be modified with a <strong class="command">git config</strong>
command. This is due to its different format that does not comply to the
<code class="docutils literal notranslate"><span class="pre">section.variable.value</span></code> structure of all other configuration files. This file, therefore,
has to be edited by hand, with an editor of your choice.</p>
</div>
<div class="section" id="environment-variables">
<h2>Environment variables<a class="headerlink" href="#environment-variables" title="Permalink to this headline">¶</a></h2>
<p>An <a class="reference internal" href="../glossary.html#term-environment-variable"><span class="xref std std-term">environment variable</span></a> is a variable set up in your shell
that affects the way the shell or certain software works – for example
the environment variables <code class="docutils literal notranslate"><span class="pre">HOME</span></code>, <code class="docutils literal notranslate"><span class="pre">PWD</span></code>, or <code class="docutils literal notranslate"><span class="pre">PATH</span></code><a class="footnote-reference brackets" href="#f4" id="id4">4</a>.
Configuration options that determine the behavior of Git, Git-annex, and
DataLad that could be defined in a configuration file can also be set (or overridden)
by the associated environment variables of these configuration options.
Many configuration items have associated environment variables.
If this environment variable is set, it takes precedence over options set in
configuration files, thus providing both an alternative way to define configurations
as well as an override mechanism. For example, the <code class="docutils literal notranslate"><span class="pre">user.name</span></code>
configuration of Git can be overridden by its associated environment variable,
<code class="docutils literal notranslate"><span class="pre">GIT_AUTHOR_NAME</span></code>. Likewise, one can define the environment variable instead
of setting the <code class="docutils literal notranslate"><span class="pre">user.name</span></code> configuration in a configuration file.</p>
<p>Git, Git-annex, and DataLad have more environment variables than anyone would want to
remember. <a class="reference external" href="https://git-scm.com/book/en/v2/Git-Internals-Environment-Variables">Here</a>
is a good overview on Git’s most useful available environment variables for a start.
All of DataLad’s configuration options can be easily translated to their
associated environment variables. Any environment variable with a name that starts with <code class="docutils literal notranslate"><span class="pre">DATALAD_</span></code>
will be available as the corresponding <code class="docutils literal notranslate"><span class="pre">datalad.</span></code> configuration variable,
replacing any <code class="docutils literal notranslate"><span class="pre">__</span></code> (two underscores) with a hyphen, then any <code class="docutils literal notranslate"><span class="pre">_</span></code> (single underscore)
with a dot, and finally converting all letters to lower case. The <code class="docutils literal notranslate"><span class="pre">datalad.log.level</span></code>
configuration option thus is the environment variable <code class="docutils literal notranslate"><span class="pre">DATALAD_LOG_LEVEL</span></code>.</p>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>This has been an intense lecture, you have to admit. One definite
take-away from it has been that you now know a second reason why the hidden
<code class="docutils literal notranslate"><span class="pre">.git</span></code> and <code class="docutils literal notranslate"><span class="pre">.datalad</span></code> directory contents and also the contents of <code class="docutils literal notranslate"><span class="pre">.gitmodules</span></code> and
<code class="docutils literal notranslate"><span class="pre">.gitattributes</span></code> should not be carelessly tempered with – they contain all of
the repositories configurations.</p>
<p>But you now also know how to modify these configurations with enough
care and background knowledge such that nothing should go wrong once you
want to work with and change them. You can use the <strong class="command">git config</strong> command
for Git configuration files on different scopes, and even the <code class="docutils literal notranslate"><span class="pre">.gitmodules</span></code> or <code class="docutils literal notranslate"><span class="pre">datalad/config</span></code>
files. Of course you do not yet know all of the available configuration options. However,
you already know some core Git configurations such as name, email, and editor. Even more
important, you know how to configure Git-annex’s content management based on <code class="docutils literal notranslate"><span class="pre">largefile</span></code>
rules, and you understand the majority of variables within <code class="docutils literal notranslate"><span class="pre">.gitmodules</span></code> or the sections
in <code class="docutils literal notranslate"><span class="pre">.git/config</span></code>. Slowly, you realize with pride,
you’re more and more becoming a DataLad power-user.</p>
<p>Write a note about configurations in datasets into <code class="docutils literal notranslate"><span class="pre">notes.txt</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cat &lt;&lt; EOT &gt;&gt; notes.txt
<span class="go">Configurations for datasets exist on different levels</span>
<span class="go">(systemwide, global, and local), and in different types</span>
<span class="go">of files (not version controlled (git)config files, or</span>
<span class="go">version controlled .datalad/config, .gitattributes, or</span>
<span class="go">gitmodules files), or environment variables.</span>
<span class="go">With the exception of .gitattributes, all configuration</span>
<span class="go">files share a common structure, and can be modified with</span>
<span class="go">the git config command, but also with an editor by hand.</span>

<span class="go">Depending on whether a configuration file is version</span>
<span class="go">controlled or not, the configurations will be shared together</span>
<span class="go">with the dataset. More specific configurations and not-shared</span>
<span class="go">configurations will always take precedence over more global or</span>
<span class="go">shared configurations, and environment variables take precedence</span>
<span class="go">over configurations in files.</span>

<span class="go">The git config --list --show-origin command is a useful tool</span>
<span class="go">to give an overview over existing configurations. Particularly</span>
<span class="go">important may be the .gitattributes file, in which one can set</span>
<span class="go">rules for Git-annex about which files should be version-controlled</span>
<span class="go">with Git instead of being annexed.</span>

<span class="go">EOT</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad save -m <span class="s2">&quot;add note on configurations and git config&quot;</span>
<span class="go">add(ok): notes.txt (file)</span>
<span class="go">save(ok): . (dataset)</span>
<span class="go">action summary:</span>
<span class="go">  add (ok: 1)</span>
<span class="go">  save (ok: 1)</span>
</pre></div>
</div>
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="f1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>When opening any file on a UNIX system, the file does not need to have a file
extension (such as <code class="docutils literal notranslate"><span class="pre">.txt</span></code>, <code class="docutils literal notranslate"><span class="pre">.pdf</span></code>, <code class="docutils literal notranslate"><span class="pre">.jpg</span></code>) for the operating system to know
how to open or use this file (in contrast to Windows, which does not know how to
open a file without an extension). To do this, Unix systems rely on a file’s
MIME type – an information about a file’s content. A <code class="docutils literal notranslate"><span class="pre">.txt</span></code> file for example
has MIME type <code class="docutils literal notranslate"><span class="pre">text/plain</span></code> as does a bash script (<code class="docutils literal notranslate"><span class="pre">.sh</span></code>), a Python
script has MIME type <code class="docutils literal notranslate"><span class="pre">text/x-python</span></code>, a <code class="docutils literal notranslate"><span class="pre">.jpg</span></code> file is <code class="docutils literal notranslate"><span class="pre">image/jpg</span></code>, and
a <code class="docutils literal notranslate"><span class="pre">.pdf</span></code> file has MIME type <code class="docutils literal notranslate"><span class="pre">application/pdf</span></code>. You can find out the MIME type
of a file by running:</p>
<blockquote>
<div><p>file –mime-type path/to/file</p>
</div></blockquote>
</dd>
<dt class="label" id="f2"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Specifying annex.largefiles in your .gitattributes file will make the configuration
“portable” – shared copies of your dataset will retain these configurations.
You could however also set largefiles rules in your <code class="docutils literal notranslate"><span class="pre">.git/config</span></code> file. Rules
specified in there take precendence over rules in <code class="docutils literal notranslate"><span class="pre">.gitattributes</span></code>. You can set
them using the <strong class="command">git config</strong> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">config</span> <span class="n">annex</span><span class="o">.</span><span class="n">largefiles</span> <span class="s1">&#39;largerthan=100kb and not (include=*.c or include=*.h)&#39;</span>
</pre></div>
</div>
<p>The above command annexes files larger than 100KB, and will never annex files with a
<code class="docutils literal notranslate"><span class="pre">.c</span></code> or <code class="docutils literal notranslate"><span class="pre">.h</span></code> extension.</p>
</dd>
<dt class="label" id="f3"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>Should you ever need to, this file is also where one would change the Git-annex
backend in order to store new files with a new backend. Switching the backend of
<em>all</em> files (new as well as existing ones) requires the <strong class="command">git annex migrate</strong>
(see <a class="reference external" href="https://git-annex.branchable.com/git-annex-migrate/">the documentation</a> for
more information on this command).</p>
</dd>
<dt class="label" id="f4"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p><strong>Some more on environment variables</strong>:
Names of environment variables are often all-uppercase. While the <code class="docutils literal notranslate"><span class="pre">$</span></code> is not part of
the name of the environment variable, it is necessary to <em>refer</em> to the environment
variable: To reference the value of the environment variable <code class="docutils literal notranslate"><span class="pre">HOME</span></code> for example you would
need to use <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">$HOME</span></code> and not <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">HOME</span></code>. However, environment variables are
set without a leading <code class="docutils literal notranslate"><span class="pre">$</span></code>. There are several ways to set an environment variable
(note that there are no spaces before and after the <code class="docutils literal notranslate"><span class="pre">=</span></code> !), leading to different
levels of availability of the variable:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">THEANSWER=42</span> <span class="pre">&lt;command&gt;</span></code> makes the variable <code class="docutils literal notranslate"><span class="pre">THEANSWER</span></code> available for the process in <code class="docutils literal notranslate"><span class="pre">&lt;command&gt;</span></code>.
For example, <code class="docutils literal notranslate"><span class="pre">DATALAD_LOG_LEVEL=debug</span> <span class="pre">datalad</span> <span class="pre">get</span> <span class="pre">&lt;file&gt;</span></code> will execute the <strong class="command">datalad get</strong>
command (and only this one) with the log level set to “debug”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">THEANSWER=42</span></code> makes the variable <code class="docutils literal notranslate"><span class="pre">THEANSWER</span></code> available for other processes in the
same session, but it will not be available to other shells.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">'export</span> <span class="pre">THEANSWER=42'</span> <span class="pre">&gt;&gt;</span> <span class="pre">~/.bashrc</span></code> will write the variable definition in the
<code class="docutils literal notranslate"><span class="pre">.bashrc</span></code> file and thus available to all future shells of the user (i.e., this will make
the variable permanent for the user)</p></li>
</ul>
<p>To list all of the configured environment variables, type <code class="docutils literal notranslate"><span class="pre">env</span></code> into your terminal.</p>
</dd>
</dl>
</div>
</div>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="101-125-config.html" title="Previous document">DIY configurations</a>
        </li>
        <li>
          <a href="101-127-procedures.html" title="Next document">Configurations to go</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>