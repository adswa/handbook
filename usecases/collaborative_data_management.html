
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>A typical collaborative data management workflow &#8212; The DataLad Handbook</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="canonical" href="http://handbook.datalad.org/usecases/collaborative_data_management.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Basic provenance tracking" href="provenance_tracking.html" />
    <link rel="prev" title="How to hide content from DataLad" href="../basics/101-179-gitignore.html" />
  

  

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    div.body {
      min-width: initial;
      max-width: initial;
    }
  </style>

  
  <link rel="canonical" href="https://handbook.datalad.org/usecases/collaborative_data_management/"/>
  <meta property="og:url" content="https://handbook.datalad.org/usecases/collaborative_data_management">
  

  <link rel="icon" type="image/png" href="https://media.readthedocs.org/images/favicon.png">

  <meta name="twitter:card" content="summary">
  <meta property="twitter:image" content="https://handbook.datalad.org/_static/social-card.jpg">
  <meta property="og:image" content="https://handbook.datalad.org/_static/social-card.jpg">
  <meta property="og:title" content="A typical collaborative data management workflow &#8212; The DataLad Handbook">
  <meta property="og:type" content="article">
  
  <meta property="og:description" content="">


  </head><body>
  <script type="text/javascript">

  $(window).scroll(function () {
    var s = $(window).scrollTop(),
          d = $(document).height(),
          c = $(window).height();
          scrollPercent = (s / (d-c)) * 100;
          var position = scrollPercent;

     $("#progressbar").attr('value', position);
  });
  </script>

  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" title="The DataLad Handbook"/>
  </a>
</p>

<p style="margin-left:auto; margin-right: auto;"><iframe src="https://ghbtns.com/github-btn.html?repo=book&user=datalad-handbook&type=star&count=true&size=large" allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe></p>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
<style>
.algolia-autocomplete{
  width: 100%;
  height: 1.5em
}
.algolia-autocomplete a{
  border-bottom: none !important;
}
#doc_search{
  width: 100%;
  height: 100%;
}
</style>

<progress id="progressbar" value="0" max="100"></progress>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">A typical collaborative data management workflow</a><ul>
<li><a class="reference internal" href="#the-challenge">The Challenge</a></li>
<li><a class="reference internal" href="#the-datalad-approach">The DataLad Approach</a></li>
<li><a class="reference internal" href="#step-by-step">Step-by-Step</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../basics/101-179-gitignore.html" title="previous chapter">How to hide content from DataLad</a></li>
      <li>Next: <a href="provenance_tracking.html" title="next chapter">Basic provenance tracking</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><!-- Alabaster (krTheme++) Hacks -->
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            <div style="display:block;position:relative; margin-bottom: 1em;">
              <div style="display:block;width:100%;padding-top:12.5%;"></div>
              <div class="rpad" data-unit="8x1" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;"></div>
            </div>
            
  <div class="section" id="a-typical-collaborative-data-management-workflow">
<span id="usecase-collab"></span><h1>A typical collaborative data management workflow<a class="headerlink" href="#a-typical-collaborative-data-management-workflow" title="Permalink to this headline">¶</a></h1>
<p>This use case sketches the basics of a common, collaborative
data management workflow for an analysis:</p>
<ol class="arabic simple">
<li><p>A 3rd party dataset is obtained to serve as input for an analysis.</p></li>
<li><p>Data processing is collaboratively performed by two colleagues.</p></li>
<li><p>Upon completion, the results are published alongside the original data
for further consumption.</p></li>
</ol>
<p>The data types and methods mentioned in this usecase belong to the scientific
field of neuroimaging, but the basic workflow is domain-agnostic.</p>
<div class="section" id="the-challenge">
<h2>The Challenge<a class="headerlink" href="#the-challenge" title="Permalink to this headline">¶</a></h2>
<p>Bob is a new PhD student and about to work on his first analysis.
He wants to use an open dataset as the input for his analysis, so he asks
a friend who has worked with the same dataset for the data and gets it
on a hard drive.
Later, he’s stuck with his analysis. Luckily, Alice, a senior grad
student in the same lab, offers to help him. He sends his script to
her via email and hopes she finds the solution to his problem. She
responds a week later with the fixed script, but in the meantime
Bob already performed some miscellaneous changes to his script as well.
Identifying and integrating her fix into his slightly changed script
takes him half a day. When he finally finishes his analysis, he wants to
publish code and data online, but can not find a way to share his data
together with his code.</p>
</div>
<div class="section" id="the-datalad-approach">
<h2>The DataLad Approach<a class="headerlink" href="#the-datalad-approach" title="Permalink to this headline">¶</a></h2>
<p>Bob creates his analysis project as a DataLad dataset. Complying with
the <a class="reference external" href="http://handbook.datalad.org/en/latest/basics/101-123-yoda.html">YODA principles</a>,
he creates his scripts in a dedicated
<code class="docutils literal notranslate"><span class="pre">code/</span></code> directory, and installs the open dataset as a standalone
DataLad subdataset within a dedicated subdirectory.
To collaborate with his senior grad
student Alice, he shares the dataset on the lab’s SSH server, and they
can collaborate on the version controlled dataset almost in real time
with no need for Bob to spend much time integrating the fix that Alice
provides him with. Afterwards, Bob can execute his scripts in a way that captures
all provenance for this results with a <strong class="command">datalad run</strong> command.
Bob can share his whole project after completion by creating a sibling
on a webserver, and pushing all of his dataset, including the input data,
to this sibling, for everyone to access and recompute.</p>
</div>
<div class="section" id="step-by-step">
<h2>Step-by-Step<a class="headerlink" href="#step-by-step" title="Permalink to this headline">¶</a></h2>
<p>Bob creates a DataLad dataset for his analysis project to live in.
Because he knows about the YODA principles, he configures the dataset
to be a YODA dataset right at the time of creation:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad create -c yoda --description <span class="s2">&quot;my 1st phd project on work computer&quot;</span> myanalysis
<span class="go">[INFO] Creating a new annex repo at /home/me/usecases/collab/myanalysis </span>
<span class="go">[INFO] Running procedure cfg_yoda </span>
<span class="go">[INFO] == Command start (output follows) ===== </span>
<span class="go">[INFO] == Command exit (modification check follows) ===== </span>
<span class="go">create(ok): /home/me/usecases/collab/myanalysis (dataset)</span>
</pre></div>
</div>
<p>After creation, there already is a <code class="docutils literal notranslate"><span class="pre">code/</span></code> directory, and all of its
inputs are version-controlled by <a class="reference internal" href="../glossary.html#term-git"><span class="xref std std-term">Git</span></a> instead of <a class="reference internal" href="../glossary.html#term-git-annex"><span class="xref std std-term">Git-annex</span></a>
thanks to the yoda procedure:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">cd</span> myanalysis
<span class="gp">$</span> tree
<span class="go">.</span>
<span class="go">├── CHANGELOG.md</span>
<span class="go">├── code</span>
<span class="go">│   └── README.md</span>
<span class="go">└── README.md</span>

<span class="go">1 directory, 3 files</span>
</pre></div>
</div>
<p>Bob knows that a DataLad dataset can contain other datasets. He also knows that
as any content of a dataset is tracked and its precise state is recorded,
this is a powerful method to specify and later resolve data dependencies,
and that including the dataset as a standalone data component will it also
make it easier to keep his analysis organized and share it later.
The dataset that Bob wants to work with is structural brain imaging data from the
<a class="reference external" href="http://studyforrest.org/">studyforrest project</a>, a public
data resource that the original authors share as a DataLad dataset through
<a class="reference internal" href="../glossary.html#term-0"><span class="xref std std-term">Github</span></a>. This means that Bob can simply install the relevant dataset from this
service and into his own dataset. To do that, he installs it as a subdataset
into a directory he calls <code class="docutils literal notranslate"><span class="pre">src/</span></code> as he wants to make it obvious which parts
of his analysis steps and code require 3rd party data:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad install -d . --source https://github.com/psychoinformatics-de/studyforrest-data-structural.git src/forrest_structural
<span class="go">[INFO] Cloning https://github.com/psychoinformatics-de/studyforrest-data-structural.git [1 other candidates] into &#39;/home/me/usecases/collab/myanalysis/src/forrest_structural&#39; </span>
<span class="go">[INFO]   Remote origin not usable by git-annex; setting annex-ignore </span>
<span class="go">install(ok): src/forrest_structural (dataset)</span>
<span class="go">action summary:</span>
<span class="go">  add (ok: 1)</span>
<span class="go">  install (ok: 1)</span>
<span class="go">  save (ok: 1)</span>
</pre></div>
</div>
<p>Now that he executed this command, Bob has access to the entire dataset
content, and the precise version of the dataset got linked to his top-level dataset
<code class="docutils literal notranslate"><span class="pre">myanalysis</span></code>. However, no data was actually downloaded (yet). Bob very much
appreciates that DataLad datasets primarily contain information on a dataset’s
content and where to obtain it: the installation above was done rather
quickly, and will still be relatively lean even for a dataset that contains
several hundred GBs of data. He knows that his script can obtain the
relevant data he needs on demand if he wraps it into a <strong class="command">datalad run</strong>
command and therefore does not need to care about getting the data yet. Instead,
he focuses to write his script <code class="docutils literal notranslate"><span class="pre">code/run_analysis.sh</span></code>.
To save this progress, he runs frequent <strong class="command">datalad save</strong> commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad save -m <span class="s2">&quot;First steps: start analysis script&quot;</span> code/run_analysis.py
<span class="go">add(ok): code/run_analysis.py (file)</span>
<span class="go">save(ok): . (dataset)</span>
<span class="go">action summary:</span>
<span class="go">  add (ok: 1)</span>
<span class="go">  save (ok: 1)</span>
</pre></div>
</div>
<p>Once Bob’s analysis is finished, he can wrap it into <strong class="command">datalad run</strong>.
To ease execution, he first makes his script executable by adding a <a class="reference internal" href="../glossary.html#term-shebang"><span class="xref std std-term">shebang</span></a>
that specifies Python as an interpreter at the start of his script, and giving it
executable permissions:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> chmod +x code/run_analysis.py
<span class="gp">$</span> datalad save -m <span class="s2">&quot;make script executable&quot;</span>
<span class="go">add(ok): code/run_analysis.py (file)</span>
<span class="go">save(ok): . (dataset)</span>
<span class="go">action summary:</span>
<span class="go">  add (ok: 1)</span>
<span class="go">  save (ok: 1)</span>
</pre></div>
</div>
<p>Importantly, prior to a <strong class="command">datalad run</strong>, he specifies the necessary
inputs such that DataLad can take care of the data retrieval for him:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad run -m <span class="s2">&quot;run first part of analysis workflow&quot;</span> <span class="se">\</span>
  --input <span class="s2">&quot;src/forrest_structural&quot;</span> <span class="se">\</span>
  --output results.txt <span class="se">\</span>
  <span class="s2">&quot;code/run_analysis.py&quot;</span>
<span class="go">[INFO] Making sure inputs are available (this may take some time) </span>
<span class="go">[INFO] == Command start (output follows) ===== </span>
<span class="go">[INFO] == Command exit (modification check follows) ===== </span>
<span class="go">get(ok): src/forrest_structural/sub-01/anat/sub-01_T1w.nii.gz (file) [from mddatasrc...]</span>
<span class="go">action summary:</span>
<span class="go">  get (ok: 1)</span>
<span class="go">  save (notneeded: 2)</span>
</pre></div>
</div>
<p>This will take care of retrieving the data, running Bobs script, and
saving all outputs.</p>
<p>Some time later, Bob needs help with his analysis. He turns to his senior
grad student Alice for help. Alice and Bob both work on the same computing server.
Bob has told Alice in which directory he keeps his analysis dataset, and
the directory is configured to have permissions that allow for
read-access for all lab-members, so Alice can obtain Bob’s work directly
from his home directory:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad install -r --source /myanalysis bobs_analysis
<span class="go">[INFO] Cloning myanalysis into &#39;/home/me/usecases/collab/bobs_analysis&#39; </span>
<span class="go">[INFO] Installing &lt;Dataset path=/home/me/usecases/collab/bobs_analysis&gt; recursively </span>
<span class="go">[INFO] Cloning /home/me/usecases/collab/myanalysis/src/forrest_structural [2 other candidates] into &#39;/home/me/usecases/collab/bobs_analysis/src/forrest_structural&#39; </span>
<span class="go">install(ok): /home/me/usecases/collab/bobs_analysis (dataset)</span>
<span class="go">action summary:</span>
<span class="go">  install (ok: 2)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">cd</span> bobs_analysis
<span class="gp">#</span> ... make contributions, and save them
<span class="gp">$</span> <span class="o">[</span>...<span class="o">]</span>
<span class="gp">$</span> datalad save -m <span class="s2">&quot;your welcome, bob&quot;</span>
<span class="go">add(ok): code/run_analysis.py (file)</span>
<span class="go">save(ok): . (dataset)</span>
<span class="go">action summary:</span>
<span class="go">  add (ok: 1)</span>
<span class="go">  save (ok: 1)</span>
</pre></div>
</div>
<p>Alice can get the studyforrest data Bob used as an input as well as the
result file, but she can also rerun his analysis by using <strong class="command">datalad rerun</strong>.
She goes ahead and fixes Bobs script, and saves the changes. To integrate her
changes into his dataset, Bob registers Alice’s dataset as a sibling:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span>in Bobs home directory
<span class="gp">$</span> datalad siblings add -s alice --url <span class="s1">&#39;/bobs_analysis&#39;</span>
<span class="go">.: alice(+) [../bobs_analysis (git)]</span>
</pre></div>
</div>
<p>Afterwards, he can get her changes with a <strong class="command">datalad update --merge</strong>
command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> datalad update -s alice --merge
<span class="go">[INFO] Fetching updates for &lt;Dataset path=/home/me/usecases/collab/myanalysis&gt; </span>
<span class="go">[INFO] Applying updates to &lt;Dataset path=/home/me/usecases/collab/myanalysis&gt; </span>
<span class="go">update(ok): . (dataset)</span>
</pre></div>
</div>
<p>Finally, when Bob is ready to share his results with the world or a remote
collaborator, he makes his dataset available by uploading them to a webserver
via SSH. Bob does so by creating a sibling for the dataset on the server, to
which the dataset can be published and later also updated.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># this generated sibling for the dataset and all subdatasets</span>
$ datalad create-sibling --recursive -s public <span class="s2">&quot;</span><span class="nv">$SERVER_URL</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>Once the remote sibling is created and registered under the name “public”,
Bob can publish his version to it.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ datalad publish -r --to public .
</pre></div>
</div>
<p>This workflow allowed Bob to obtain data, collaborate with Alice, and publish
or share his dataset with others easily – he cannot wait for his next project,
given that this workflow made his life so simple.</p>
</div>
</div>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="../basics/101-179-gitignore.html" title="Previous document">How to hide content from DataLad</a>
        </li>
        <li>
          <a href="provenance_tracking.html" title="Next document">Basic provenance tracking</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>